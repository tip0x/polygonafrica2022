{"ast":null,"code":"/* Copyright (c) 2013 LevelUP contributors\n * See list at <https://github.com/rvagg/node-levelup#contributing>\n * MIT +no-false-attribs License\n * <https://github.com/Level/level-ws/master/LICENSE>\n */\n\nvar Writable = require('stream').Writable || require('readable-stream').Writable,\n  inherits = require('util').inherits,\n  extend = require('xtend'),\n  defaultOptions = {\n    type: 'put',\n    keyEncoding: 'utf8',\n    valueEncoding: 'utf8'\n  }\n\n  // copied from LevelUP\n  ,\n  encodingNames = ['hex', 'utf8', 'utf-8', 'ascii', 'binary', 'base64', 'ucs2', 'ucs-2', 'utf16le', 'utf-16le']\n\n  // copied from LevelUP\n  ,\n  encodingOpts = function () {\n    var eo = {};\n    encodingNames.forEach(function (e) {\n      eo[e] = {\n        valueEncoding: e\n      };\n    });\n    return eo;\n  }();\n\n// copied from LevelUP\nfunction getOptions(levelup, options) {\n  var s = typeof options == 'string'; // just an encoding\n  if (!s && options && options.encoding && !options.valueEncoding) options.valueEncoding = options.encoding;\n  return extend(levelup && levelup.options || {}, s ? encodingOpts[options] || encodingOpts[defaultOptions.valueEncoding] : options);\n}\nfunction WriteStream(options, db) {\n  if (!(this instanceof WriteStream)) return new WriteStream(options, db);\n  Writable.call(this, {\n    objectMode: true\n  });\n  this._options = extend(defaultOptions, getOptions(db, options));\n  this._db = db;\n  this._buffer = [];\n  this.writable = true;\n  this.readable = false;\n  var self = this;\n  this.on('finish', function f() {\n    if (self._buffer && self._buffer.length) {\n      return self._flush(f);\n    }\n    self.writable = false;\n    self.emit('close');\n  });\n}\ninherits(WriteStream, Writable);\nWriteStream.prototype._write = function write(d, enc, next) {\n  var self = this;\n  if (self._destroyed) return;\n  if (!self._db.isOpen()) return self._db.once('ready', function () {\n    write.call(self, d, enc, next);\n  });\n  if (self._options.maxBufferLength && self._buffer.length > self._options.maxBufferLength) {\n    self.once('_flush', next);\n  } else {\n    if (self._buffer.length === 0) process.nextTick(function () {\n      self._flush();\n    });\n    self._buffer.push(d);\n    next();\n  }\n};\nWriteStream.prototype._flush = function (f) {\n  var self = this,\n    buffer = self._buffer;\n  if (self._destroyed || !buffer) return;\n  if (!self._db.isOpen()) {\n    return self._db.on('ready', function () {\n      self._flush(f);\n    });\n  }\n  self._buffer = [];\n  self._db.batch(buffer.map(function (d) {\n    return {\n      type: d.type || self._options.type,\n      key: d.key,\n      value: d.value,\n      keyEncoding: d.keyEncoding || self._options.keyEncoding,\n      valueEncoding: d.valueEncoding || d.encoding || self._options.valueEncoding\n    };\n  }), cb);\n  function cb(err) {\n    if (err) {\n      self.writable = false;\n      self.emit('error', err);\n    } else {\n      if (f) f();\n      self.emit('_flush');\n    }\n  }\n};\nWriteStream.prototype.toString = function () {\n  return 'LevelUP.WriteStream';\n};\nWriteStream.prototype.destroy = function () {\n  if (this._destroyed) return;\n  this._buffer = null;\n  this._destroyed = true;\n  this.writable = false;\n  this.emit('close');\n};\nWriteStream.prototype.destroySoon = function () {\n  this.end();\n};\nmodule.exports = function (db) {\n  db.writeStream = db.createWriteStream = function (options) {\n    return new WriteStream(options, db);\n  };\n  return db;\n};\nmodule.exports.WriteStream = WriteStream;","map":{"version":3,"names":["Writable","require","inherits","extend","defaultOptions","type","keyEncoding","valueEncoding","encodingNames","encodingOpts","eo","forEach","e","getOptions","levelup","options","s","encoding","WriteStream","db","call","objectMode","_options","_db","_buffer","writable","readable","self","on","f","length","_flush","emit","prototype","_write","write","d","enc","next","_destroyed","isOpen","once","maxBufferLength","process","nextTick","push","buffer","batch","map","key","value","cb","err","toString","destroy","destroySoon","end","module","exports","writeStream","createWriteStream"],"sources":["/home/tiptape/relearningculture/zkevm/frontend/node_modules/level-ws/level-ws.js"],"sourcesContent":["/* Copyright (c) 2013 LevelUP contributors\n * See list at <https://github.com/rvagg/node-levelup#contributing>\n * MIT +no-false-attribs License\n * <https://github.com/Level/level-ws/master/LICENSE>\n */\n\nvar Writable = require('stream').Writable || require('readable-stream').Writable\n  , inherits = require('util').inherits\n  , extend   = require('xtend')\n\n  , defaultOptions = {\n        type          : 'put'\n      , keyEncoding   : 'utf8'\n      , valueEncoding : 'utf8'\n    }\n\n    // copied from LevelUP\n  , encodingNames  = [\n        'hex'\n      , 'utf8'\n      , 'utf-8'\n      , 'ascii'\n      , 'binary'\n      , 'base64'\n      , 'ucs2'\n      , 'ucs-2'\n      , 'utf16le'\n      , 'utf-16le'\n    ]\n\n    // copied from LevelUP\n  , encodingOpts = (function () {\n      var eo = {}\n      encodingNames.forEach(function (e) {\n        eo[e] = { valueEncoding : e }\n      })\n      return eo\n    }())\n\n// copied from LevelUP\nfunction getOptions (levelup, options) {\n  var s = typeof options == 'string' // just an encoding\n  if (!s && options && options.encoding && !options.valueEncoding)\n    options.valueEncoding = options.encoding\n  return extend(\n      (levelup && levelup.options) || {}\n    , s ? encodingOpts[options] || encodingOpts[defaultOptions.valueEncoding]\n        : options\n  )\n}\n\nfunction WriteStream (options, db) {\n  if (!(this instanceof WriteStream))\n    return new WriteStream(options, db)\n\n  Writable.call(this, { objectMode: true })\n  this._options = extend(defaultOptions, getOptions(db, options))\n  this._db      = db\n  this._buffer = []\n  this.writable = true\n  this.readable = false\n\n  var self = this\n  this.on('finish', function f () {\n    if (self._buffer && self._buffer.length) {\n      return self._flush(f)\n    }\n    self.writable = false\n    self.emit('close')\n  })\n}\n\ninherits(WriteStream, Writable)\n\nWriteStream.prototype._write = function write (d, enc, next) {\n  var self = this\n  if (self._destroyed)\n    return\n  if (!self._db.isOpen())\n    return self._db.once('ready', function () {\n      write.call(self, d, enc, next)\n    })\n\n  if (self._options.maxBufferLength &&\n      self._buffer.length > self._options.maxBufferLength) {\n    self.once('_flush', next)\n  }\n  else {\n    if (self._buffer.length === 0)\n      process.nextTick(function () { self._flush() })\n    self._buffer.push(d)\n    next()\n  }\n}\n\nWriteStream.prototype._flush = function (f) {\n  var self = this\n    , buffer = self._buffer\n\n  if (self._destroyed || !buffer) return\n \n  if (!self._db.isOpen()) {\n    return self._db.on('ready', function () { self._flush(f) })\n  }\n  self._buffer = []\n\n  self._db.batch(buffer.map(function (d) {\n    return {\n        type          : d.type || self._options.type\n      , key           : d.key\n      , value         : d.value\n      , keyEncoding   : d.keyEncoding || self._options.keyEncoding\n      , valueEncoding : d.valueEncoding\n          || d.encoding\n          || self._options.valueEncoding\n    }\n  }), cb)\n\n  function cb (err) {\n    if (err) {\n      self.writable = false\n      self.emit('error', err)\n    }\n    else {\n      if (f) f()\n      self.emit('_flush')\n    }\n  }\n}\n\nWriteStream.prototype.toString = function () {\n  return 'LevelUP.WriteStream'\n}\n\nWriteStream.prototype.destroy = function () {\n  if (this._destroyed) return\n  this._buffer = null\n  this._destroyed = true\n  this.writable = false\n  this.emit('close')\n}\n\nWriteStream.prototype.destroySoon = function () {\n  this.end()\n}\n\nmodule.exports = function (db) {\n  db.writeStream = db.createWriteStream = function (options) {\n    return new WriteStream(options, db)\n  }\n  return db\n}\n\nmodule.exports.WriteStream = WriteStream"],"mappings":"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"},"metadata":{},"sourceType":"script"}